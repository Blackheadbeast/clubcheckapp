generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

model Owner {
  id                String   @id @default(uuid())
  email             String   @unique
  password          String
  createdAt         DateTime @default(now())
  
  stripeCustomerId       String?
  stripeSubscriptionId   String?
  subscriptionStatus     String?
  currentPeriodEnd       DateTime?
  planType               String   @default("starter")
  
  members           Member[]
  checkins          Checkin[]
}

model Member {
  id          String   @id @default(uuid())
  name        String
  email       String
  phone       String?
  status      String   @default("active")
  qrCode      String   @unique
  createdAt   DateTime @default(now())
  
  ownerId     String
  owner       Owner    @relation(fields: [ownerId], references: [id], onDelete: Cascade)
  
  stripeCustomerId       String?
  stripeSubscriptionId   String?
  subscriptionStatus     String?
  cardLast4              String?
  cardExpiryMonth        Int?
  cardExpiryYear         Int?
  
  checkins    Checkin[]
}

model Checkin {
  id          String   @id @default(uuid())
  timestamp   DateTime @default(now())
  
  memberId    String
  member      Member   @relation(fields: [memberId], references: [id], onDelete: Cascade)
  
  ownerId     String
  owner       Owner    @relation(fields: [ownerId], references: [id], onDelete: Cascade)
}